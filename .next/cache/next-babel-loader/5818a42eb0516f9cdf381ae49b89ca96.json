{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/ilyakaminsky/Downloads/frontend_test_ikaminskii-master/src/components/Library/LibraryTable.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { tableCells } from \"./config\";\nimport { Tooltip, TextField, Button } from '@material-ui/core';\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport { orderBy } from 'lodash';\nimport AddBookMagazineDialog from \"./AddBookMagazineDialog\";\nimport ExportDataDialog from \"./ExportDataDialog\";\nimport { SORTING_TYPES, FILTER_PLACEHOLDER, FILTER_STYLES, TABLE_HEADER_STYLES, CURSORS, TABLE_HEADER_SPAN_STYLES, LIBRARY_ITEM_STYLES, LIBRARY_STYLES } from \"../../utils/consts\";\n\nvar LibraryTable = function LibraryTable() {\n  _s();\n\n  var libraryFullData = useSelector(function (state) {\n    var _state$library;\n\n    return (_state$library = state.library) === null || _state$library === void 0 ? void 0 : _state$library.fullData;\n  });\n\n  var _useState = useState([]),\n      libraryData = _useState[0],\n      setLibraryData = _useState[1];\n\n  var _useState2 = useState({\n    field: SORTING_TYPES.field,\n    order: SORTING_TYPES.order\n  }),\n      sortParameters = _useState2[0],\n      setSortParameters = _useState2[1];\n\n  var _useState3 = useState(''),\n      filterValue = _useState3[0],\n      setFilterValue = _useState3[1];\n\n  var _useState4 = useState(false),\n      openAddBookMagazineDialogState = _useState4[0],\n      setOpenAddBookMagazineDialogState = _useState4[1];\n\n  var _useState5 = useState(false),\n      openExportDataDialogState = _useState5[0],\n      setOpenExportDataDialogState = _useState5[1];\n\n  useEffect(function () {\n    var libraryFilteredData = !filterValue ? libraryFullData : libraryFullData.filter(function (item) {\n      if (item.isbn.toString().toLowerCase().includes(filterValue.toLowerCase())) {\n        return true;\n      }\n\n      var authorsMails = '';\n      item.authors.forEach(function (author) {\n        authorsMails += \"\".concat(author.email, \" \");\n      });\n      return authorsMails.toLowerCase().includes(filterValue.toLowerCase());\n    });\n    libraryFilteredData && setLibraryData(orderBy(libraryFilteredData, sortParameters.field, sortParameters.asc));\n  }, [libraryFullData === null || libraryFullData === void 0 ? void 0 : libraryFullData.length, sortParameters, filterValue]);\n\n  var closeAddBookMagazineDialog = function closeAddBookMagazineDialog() {\n    setOpenAddBookMagazineDialogState(false);\n  };\n\n  var openAddBookMagazineDialog = function openAddBookMagazineDialog() {\n    setOpenAddBookMagazineDialogState(true);\n  };\n\n  var closeExportDataDialog = function closeExportDataDialog() {\n    setOpenExportDataDialogState(false);\n  };\n\n  var openExportDataDialog = function openExportDataDialog() {\n    setOpenExportDataDialogState(true);\n  };\n\n  var makeFilterInput = function makeFilterInput() {\n    return __jsx(TextField, {\n      onChange: function onChange(e) {\n        setFilterValue(e.target.value);\n      },\n      value: filterValue,\n      placeholder: FILTER_PLACEHOLDER,\n      style: FILTER_STYLES,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 5\n      }\n    });\n  };\n\n  var makeTableHeader = function makeTableHeader() {\n    return __jsx(\"div\", {\n      style: TABLE_HEADER_STYLES,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 5\n      }\n    }, tableCells.map(function (item, headerCellIndex) {\n      return __jsx(\"div\", {\n        style: _objectSpread(_objectSpread({}, item.cellStyle), {}, {\n          cursor: item.isSortable ? CURSORS.pointer : CURSORS.auto\n        }),\n        key: \"library-table-header-\".concat(headerCellIndex),\n        onClick: function onClick(e) {\n          e.stopPropagation();\n          item.isSortable && setSortParameters({\n            field: item.title,\n            order: sortParameters.order === SORTING_TYPES.asc ? SORTING_TYPES.desc : SORTING_TYPES.asc\n          });\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 9\n        }\n      }, item.headerTitle, __jsx(\"span\", {\n        style: TABLE_HEADER_SPAN_STYLES,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }\n      }, sortParameters.field === item.title ? sortParameters.order === SORTING_TYPES.asc ? __jsx(ArrowUpwardIcon, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 60\n        }\n      }) : __jsx(ArrowDownwardIcon, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 82\n        }\n      }) : ''));\n    }));\n  };\n\n  var makeRowCellForObjectValue = function makeRowCellForObjectValue(objectItem, rowIndex) {\n    return objectItem.value ? objectItem.value : __jsx(React.Fragment, null, objectItem.map(function (item, index) {\n      return __jsx(\"div\", {\n        key: \"library-table-row-tooltip-cell-\".concat(rowIndex, \"-4-\").concat(index),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 7\n        }\n      }, __jsx(Tooltip, {\n        title: item.email,\n        interactive: true,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 9\n        }\n      }, __jsx(\"span\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }\n      }, item.firstname, \" \", item.lastname)));\n    }));\n  };\n\n  var makeTableRows = function makeTableRows() {\n    return __jsx(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 7\n      }\n    }, libraryData === null || libraryData === void 0 ? void 0 : libraryData.map(function (item, rowIndex) {\n      return __jsx(\"div\", {\n        key: \"library-table-row-\".concat(rowIndex),\n        style: LIBRARY_ITEM_STYLES,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }\n      }, tableCells.map(function (cell, cellIndex) {\n        return __jsx(\"div\", {\n          key: \"library-table-row-cell-\".concat(rowIndex, \"-\").concat(cellIndex),\n          style: cell.cellStyle,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 17\n          }\n        }, typeof item[cell.title] !== 'object' ? item[cell.title] : makeRowCellForObjectValue(item[cell.title], rowIndex));\n      }));\n    }));\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    style: LIBRARY_STYLES,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }\n  }, makeFilterInput(), __jsx(\"div\", {\n    style: {\n      position: 'absolute',\n      right: '8px',\n      top: '6px'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 9\n    }\n  }, __jsx(Button, {\n    onClick: openAddBookMagazineDialog,\n    variant: \"contained\",\n    style: {\n      marginRight: '8px'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 11\n    }\n  }, \"Add Book / Magazine\"), __jsx(Button, {\n    onClick: openExportDataDialog,\n    variant: \"contained\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 11\n    }\n  }, \"Export\"))), makeTableHeader(), makeTableRows(), __jsx(AddBookMagazineDialog, {\n    openState: openAddBookMagazineDialogState,\n    onCloseCallback: closeAddBookMagazineDialog,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }\n  }), __jsx(ExportDataDialog, {\n    openState: openExportDataDialogState,\n    onCloseCallback: closeExportDataDialog,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 7\n    }\n  }));\n};\n\n_s(LibraryTable, \"0kBefiV5dIUjPr4MBjhHEokYgqQ=\", false, function () {\n  return [useSelector];\n});\n\n_c = LibraryTable;\nexport default LibraryTable;\n\nvar _c;\n\n$RefreshReg$(_c, \"LibraryTable\");","map":{"version":3,"sources":["/Users/ilyakaminsky/Downloads/frontend_test_ikaminskii-master/src/components/Library/LibraryTable.js"],"names":["React","useEffect","useState","useSelector","tableCells","Tooltip","TextField","Button","ArrowUpwardIcon","ArrowDownwardIcon","orderBy","AddBookMagazineDialog","ExportDataDialog","SORTING_TYPES","FILTER_PLACEHOLDER","FILTER_STYLES","TABLE_HEADER_STYLES","CURSORS","TABLE_HEADER_SPAN_STYLES","LIBRARY_ITEM_STYLES","LIBRARY_STYLES","LibraryTable","libraryFullData","state","library","fullData","libraryData","setLibraryData","field","order","sortParameters","setSortParameters","filterValue","setFilterValue","openAddBookMagazineDialogState","setOpenAddBookMagazineDialogState","openExportDataDialogState","setOpenExportDataDialogState","libraryFilteredData","filter","item","isbn","toString","toLowerCase","includes","authorsMails","authors","forEach","author","email","asc","length","closeAddBookMagazineDialog","openAddBookMagazineDialog","closeExportDataDialog","openExportDataDialog","makeFilterInput","e","target","value","makeTableHeader","map","headerCellIndex","cellStyle","cursor","isSortable","pointer","auto","stopPropagation","title","desc","headerTitle","makeRowCellForObjectValue","objectItem","rowIndex","index","firstname","lastname","makeTableRows","cell","cellIndex","position","right","top","marginRight"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useSelector } from 'react-redux'\r\nimport { tableCells } from './config';\r\nimport { Tooltip, TextField, Button } from '@material-ui/core';\r\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\r\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\r\nimport { orderBy } from 'lodash';\r\nimport AddBookMagazineDialog from './AddBookMagazineDialog'\r\nimport ExportDataDialog from './ExportDataDialog'\r\nimport {\r\n  SORTING_TYPES,\r\n  FILTER_PLACEHOLDER,\r\n  FILTER_STYLES,\r\n  TABLE_HEADER_STYLES,\r\n  CURSORS,\r\n  TABLE_HEADER_SPAN_STYLES, LIBRARY_ITEM_STYLES, LIBRARY_STYLES\r\n} from '../../utils/consts'\r\n\r\n\r\nconst LibraryTable = () => {\r\n\r\n  const libraryFullData = useSelector(state => (state.library?.fullData));\r\n  const [libraryData, setLibraryData] = useState([]);\r\n  const [sortParameters, setSortParameters] = useState({field: SORTING_TYPES.field, order: SORTING_TYPES.order});\r\n  const [filterValue, setFilterValue] = useState('');\r\n  const [openAddBookMagazineDialogState, setOpenAddBookMagazineDialogState] = useState(false);\r\n  const [openExportDataDialogState, setOpenExportDataDialogState] = useState(false);\r\n\r\n  useEffect(() => {\r\n    let libraryFilteredData = !filterValue ? libraryFullData : libraryFullData.filter((item) => {\r\n      if (item.isbn.toString().toLowerCase().includes(filterValue.toLowerCase())) {\r\n        return true\r\n      }\r\n      let authorsMails = '';\r\n      item.authors.forEach(author => {authorsMails += `${author.email} `});\r\n      return authorsMails.toLowerCase().includes(filterValue.toLowerCase());\r\n    });\r\n\r\n    libraryFilteredData && setLibraryData(orderBy(libraryFilteredData, sortParameters.field, sortParameters.asc));\r\n  }, [libraryFullData?.length, sortParameters, filterValue]);\r\n\r\n  const closeAddBookMagazineDialog = () => {\r\n    setOpenAddBookMagazineDialogState(false);\r\n  }\r\n  const openAddBookMagazineDialog = () => {\r\n    setOpenAddBookMagazineDialogState(true);\r\n  }\r\n\r\n  const closeExportDataDialog = () => {\r\n    setOpenExportDataDialogState(false);\r\n  }\r\n  const openExportDataDialog = () => {\r\n    setOpenExportDataDialogState(true);\r\n  }\r\n\r\n  const makeFilterInput = () => (\r\n    <TextField\r\n      onChange={(e) => {\r\n        setFilterValue(e.target.value);\r\n      }}\r\n      value={filterValue}\r\n      placeholder={FILTER_PLACEHOLDER}\r\n      style={FILTER_STYLES}\r\n    />\r\n  );\r\n\r\n  const makeTableHeader = () => (\r\n    <div style={TABLE_HEADER_STYLES}>\r\n      {tableCells.map((item, headerCellIndex) => (\r\n        <div\r\n          style={{...item.cellStyle, cursor: item.isSortable? CURSORS.pointer : CURSORS.auto}}\r\n          key={`library-table-header-${headerCellIndex}`}\r\n          onClick={(e) => {\r\n            e.stopPropagation();\r\n            item.isSortable && setSortParameters({\r\n              field: item.title, order: sortParameters.order === SORTING_TYPES.asc ? SORTING_TYPES.desc : SORTING_TYPES.asc\r\n            });\r\n          }}\r\n        >\r\n          {item.headerTitle}\r\n          <span style={TABLE_HEADER_SPAN_STYLES}>\r\n            {sortParameters.field === item.title ? (\r\n              sortParameters.order === SORTING_TYPES.asc ? <ArrowUpwardIcon /> : <ArrowDownwardIcon />\r\n            ) : ''}\r\n          </span>\r\n        </div>\r\n      ))}\r\n    </div>);\r\n\r\n  const makeRowCellForObjectValue = (objectItem, rowIndex) => {\r\n    return (\r\n    objectItem.value ? objectItem.value:\r\n      (<>{objectItem.map((item, index) => (\r\n      <div key={`library-table-row-tooltip-cell-${rowIndex}-4-${index}`}>\r\n        <Tooltip title={item.email} interactive={true}>\r\n          <span>{item.firstname} {item.lastname}</span>\r\n        </Tooltip>\r\n      </div>\r\n    ))}</>)\r\n  )}\r\n\r\n  const makeTableRows = () => {\r\n    return (\r\n      <div>\r\n        {libraryData?.map((item, rowIndex) => {\r\n          return (\r\n            <div\r\n              key={`library-table-row-${rowIndex}`}\r\n              style={LIBRARY_ITEM_STYLES}\r\n            >\r\n              {tableCells.map((cell, cellIndex) => (\r\n                <div\r\n                  key={`library-table-row-cell-${rowIndex}-${cellIndex}`}\r\n                  style={cell.cellStyle}\r\n                >\r\n                  {typeof item[cell.title] !== 'object' ? item[cell.title] : makeRowCellForObjectValue(item[cell.title], rowIndex)}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>)\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div style={LIBRARY_STYLES}>\r\n        {makeFilterInput()}\r\n        <div style={{position: 'absolute', right: '8px', top: '6px'}}>\r\n          <Button\r\n            onClick={openAddBookMagazineDialog}\r\n            variant=\"contained\"\r\n            style={{marginRight: '8px'}}\r\n          >\r\n            Add Book / Magazine\r\n          </Button>\r\n          <Button\r\n            onClick={openExportDataDialog}\r\n            variant=\"contained\"\r\n          >\r\n            Export\r\n          </Button>\r\n        </div>\r\n      </div>\r\n      {makeTableHeader()}\r\n      {makeTableRows()}\r\n      <AddBookMagazineDialog\r\n        openState={openAddBookMagazineDialogState}\r\n        onCloseCallback={closeAddBookMagazineDialog}\r\n      />\r\n      <ExportDataDialog\r\n        openState={openExportDataDialogState}\r\n        onCloseCallback={closeExportDataDialog}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default LibraryTable;\r\n"]},"metadata":{},"sourceType":"module"}